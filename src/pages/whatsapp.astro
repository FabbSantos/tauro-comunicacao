---
import Layout from '../layouts/Layout.astro';
import Header from '../components/Header.astro';
import Footer from '../components/Footer.astro';
import Button from '../components/Button.astro';
---

<Layout title='WhatsApp Marketing - Tauro Comunicações'>
	<Header />
	<main class='pt-32 bg-gradient-to-bl from-[#020211] to-[#1e144b]'>
		<section class='container mx-auto px-6 pb-20'>
			<div
				class='max-w-3xl space-y-8 mx-auto flex flex-col justify-center items-center text-center'
			>
				<h1 class='text-5xl md:text-6xl font-bold leading-tight'>
					<span class='text-primary-cyan'>WhatsApp</span> Marketing
				</h1>
				<p class='text-white/70 text-lg leading-relaxed'>
					Potencialize sua comunicação com o aplicativo mais usado do
					Brasil. Envios segmentados, automação inteligente e
					interação rica com mídia, botões e fluxos.
				</p>
				<div class='flex flex-wrap gap-4'>
					<Button href='/sms'>Ver SMS</Button>
					<Button
						href='/'
						variant='secondary'
						>Voltar</Button
					>
				</div>
			</div>

			<div
				class='grid md:grid-cols-3 gap-8 mt-16 text-center md:text-left'
			>
				<div
					class='bg-black/40 backdrop-blur-sm rounded-2xl p-6 border border-white/10'
				>
					<h3 class='text-xl font-semibold mb-3'>Alta Entrega</h3>
					<p class='text-white/60 text-sm leading-relaxed'>
						98% das mensagens são lidas em até 3 minutos.
					</p>
				</div>
				<div
					class='bg-black/40 backdrop-blur-sm rounded-2xl p-6 border border-white/10'
				>
					<h3 class='text-xl font-semibold mb-3'>Interatividade</h3>
					<p class='text-white/60 text-sm leading-relaxed'>
						Comunicação instantânea e próxima.
					</p>
				</div>
				<div
					class='bg-black/40 backdrop-blur-sm rounded-2xl p-6 border border-white/10'
				>
					<h3 class='text-xl font-semibold mb-3'>Engajamento</h3>
					<p class='text-white/60 text-sm leading-relaxed'>
						Engajamento real e alto índice de geração de leads.
					</p>
				</div>
			</div>

			<div
				class='mt-20 max-w-xl mx-auto'
				id='contato'
			>
				<h2 class='text-3xl font-bold mb-6 text-center'>
					Solicite uma demonstração
				</h2>
				<form
					id='form-whatsapp'
					class='space-y-5'
				>
					<div class='grid md:grid-cols-2 gap-5'>
						<input
							type='text'
							name='nome'
							placeholder='Nome'
							required
							class='w-full px-5 py-3 bg-black/40 backdrop-blur-sm rounded-xl border border-white/10 focus:outline-none focus:ring-2 focus:ring-primary-cyan/40 text-white placeholder-white/40 text-sm'
						/>
						<input
							type='email'
							name='email'
							placeholder='E-mail'
							required
							class='w-full px-5 py-3 bg-black/40 backdrop-blur-sm rounded-xl border border-white/10 focus:outline-none focus:ring-2 focus:ring-primary-cyan/40 text-white placeholder-white/40 text-sm'
						/>
					</div>
					<input
						type='tel'
						name='telefone'
						placeholder='Telefone'
						class='w-full px-5 py-3 bg-black/40 backdrop-blur-sm rounded-xl border border-white/10 focus:outline-none focus:ring-2 focus:ring-primary-cyan/40 text-white placeholder-white/40 text-sm'
					/>
					<textarea
						name='mensagem'
						rows='4'
						placeholder='Explique seu caso'
						class='w-full px-5 py-3 bg-black/40 backdrop-blur-sm rounded-xl border border-white/10 focus:outline-none focus:ring-2 focus:ring-primary-cyan/40 text-white placeholder-white/40 text-sm'
					></textarea>
					<Button
						class='w-full py-3'
						id='submit-btn-wpp'
					>
						<span id='btn-text-wpp'>Enviar</span>
						<span
							id='btn-loading-wpp'
							class='hidden'
							>Enviando...</span
						>
					</Button>
				</form>
				<div
					id='form-status-wpp'
					class='hidden mt-4 p-4 rounded-lg'
				>
				</div>
			</div>
		</section>
	</main>
	<Footer />
</Layout>

<script>
	const form = document.getElementById('form-whatsapp') as HTMLFormElement;
	const status = document.getElementById('form-status-wpp') as HTMLDivElement;
	const btnText = document.getElementById('btn-text-wpp') as HTMLSpanElement;
	const btnLoading = document.getElementById(
		'btn-loading-wpp'
	) as HTMLSpanElement;
	const submitBtn = document.getElementById(
		'submit-btn-wpp'
	) as HTMLButtonElement;

	form?.addEventListener('submit', async (e) => {
		e.preventDefault();

		submitBtn.disabled = true;
		btnText.classList.add('hidden');
		btnLoading.classList.remove('hidden');

		const formData = new FormData(form);
		const data = {
			nome: formData.get('nome'),
			email: formData.get('email'),
			telefone: formData.get('telefone'),
			mensagem: formData.get('mensagem'),
		};

		try {
			const response = await fetch('/api/send-email', {
				method: 'POST',
				headers: {
					'Content-Type': 'application/json',
				},
				body: JSON.stringify(data),
			});

			if (response.ok) {
				status.innerHTML =
					'✅ Mensagem enviada com sucesso! Entraremos em contato em breve.';
				status.className =
					'mt-4 p-4 rounded-lg bg-green-500/20 text-green-400 border border-green-500/40';
				status.classList.remove('hidden');
				form.reset();
			} else {
				throw new Error('Erro ao enviar');
			}
		} catch (error) {
			status.innerHTML = '❌ Erro ao enviar mensagem. Tente novamente.';
			status.className =
				'mt-4 p-4 rounded-lg bg-red-500/20 text-red-400 border border-red-500/40';
			status.classList.remove('hidden');
		} finally {
			submitBtn.disabled = false;
			btnText.classList.remove('hidden');
			btnLoading.classList.add('hidden');
		}

		setTimeout(() => status.classList.add('hidden'), 5000);
	});
</script>
